{% extends 'components/base.html.twig' %}
{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('css/eventsToCome.css') }}">
	<link rel="stylesheet" href="{{ asset('css/cardApercuEvent.css') }}">
	<link rel="stylesheet" href="{{ asset('css/boutonsEtInputs.css') }}">

{% endblock %}
{% block title %}
	{{ SiteName }}: Évènements à venir
{% endblock %}

{% block body %}

	<div class="wrapper">
		{% set countAVenir = countTotalEventsToCome[0][1] %}
		{% set countPasse = countTotalCompletedEvents[0][1] %}

		{% if countAVenir > 0 %}
			{% if countAVenir == 1 %}
				<h1>Évènement à venir: 1</h1>
			{% else %}
				<h1>Évènements à venir: 
					{{ countAVenir }}
				</h1>
			{% endif %}
		{% else %}
			<h1>Aucun évènement à venir</h1>
			{% if countPasse > 0 %}
				<h4>Voir aussi
					<a class="bouton bt2" href="{{ path('completed_events') }}">
						Évènements passés
					</a>
				</h4>
			{% endif %}


		{% endif %}

		<section class="events" id="events">
			<div
				class="bloc-cards">
				{# On affiche les evènements futurs #}
				{% if eventsToCome is not empty %}
					{% for eventToCome in eventsToCome %}
						<div
							class="card-wraper">
							{# Si c'est un event annulé, on affiche le tampon annulé, et on grise la carte #}
							{% if eventToCome.getAnnule() %}
								<div class="tampon-oblique tampon-oblique-red">Évènement annulé</div>
								<a class="card-event card-event-grise" href="{{ path('event_', {id: eventToCome.id}) }}">
								{% else %}
									<a class="card-event" href="{{ path('event_', {id: eventToCome.id}) }}">
									{% endif %}
									<div class="image">
										{% if eventToCome.getImagesEvents[0] is defined %}
											{# On affiche l'image de l'event #}
											<img src="{{ asset('uploads/imagesEvents/' ~ 'min_' ~ eventToCome.getImagesEvents[0].Nom) }}">
										{% else %}
											{# On affiche l'image de remplacement par défaut #}
											<img title="Aucune image de disponible" src="{{ asset('images/min_imageDefaut.jpg') }}">
										{% endif %}
									</div>
									<div class="bloc-text">
										<h3 class="titre">{{ eventToCome.getNom() }}</h3>
										<p class="hook">{{ eventToCome.getHook() }}</p>
										<div class="center">
											<div class="bouton bt-inline-bloc">
												Voir
											</div>
										</div>
										{# Date, et mentions couleurs du nbr de jours avant l'event #}
										<div class="infos">
											<div class="events-date">
												<i class="fas fa-calendar-alt"></i>
												{{ eventToCome.getDateEvent()|date("d-m-Y") }}
											</div>
											{% if eventToCome.ImagesEvents | length > 1 %}
												<div class="events-nbr-images">
													<i class="fas fa-file-image"></i>
													{{ eventToCome.ImagesEvents | length }}
												</div>
											{% endif %}
											{% for j in 0..7 %}
												{% if j == 0 %}
													{% if eventToCome.getDateEvent()|date("Y-m-d") == today|date("Y-m-d")|date("Y-m-d") %}
														<span class="info-jour green">Aujourd'hui</span>
													{% endif %}
												{% elseif j == 1 %}
													{% if eventToCome.getDateEvent()|date("Y-m-d") == today|date_modify("+"~ j ~" day")|date("Y-m-d") %}
														<span class="info-jour blue">demain</span>
													{% endif %}
												{% else %}
													{% if eventToCome.getDateEvent()|date("Y-m-d") == today|date_modify("+"~ j ~" day")|date("Y-m-d") %}
														<span class="info-jour blue">J-{{ j }}</span>
													{% endif %}
												{% endif %}
											{% endfor %}
										</div>
									</div>
								</a>
							</div>
						{% endfor %}
					{% endif %}
					{# ====================================================== #}

				</div>
			</section>
		</div>
	{% endblock %}
