{% extends 'components/base.html.twig' %}
{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('css/adminTableCrud.css') }}">
	<link rel="stylesheet" href="{{ asset('css/boutonsEtInputs.css') }}">
{% endblock %}


{% block title %}
	{{ SiteName }}: Gérer les Évènements à venir
{% endblock %}

{% block body %}
	<div class="wrapper">

		<h1>
			Gérer les Évènements à venir
		</h1>

		<div class="conteneur_table">
			<div class="table-admin-dashboard">
				<div>
					<a class="boutonNew boutonFlecheGauche" href="{{ path('admin.events.passes') }}" title="Gérer les évènements passés">
						<i class="fas fa-arrow-left fa-lg flecheGauche"></i>
						Passés
					</a>
				</div>
				<div>
					<a class="boutonNew" href="{{ path('admin.events.nouveau') }}" title="Créer un nouvel évènement">Nouveau
					</a>
				</div>
			</div>

			<table class="table_1">
				<thead>
					<tr>
						<th>Titre</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					{% if eventsToCome is not empty %}
						{% for eventToCome in eventsToCome %}
							<tr>
								<td>
									<div class="blocTitreImage">
										<div class="titreEtInfos">
											{% if eventToCome.getAnnule() %}
												<div class="annule" title="Évènement annulé">
													{{ eventToCome.nom }}
												</div>
											{% else %}
												{{ eventToCome.nom }}
											{% endif %}
											<div class="date">
												{{ eventToCome.getDateEvent()|date("d-m-Y") }}
											</div>
											{# ==== On affiche le nbre d'images ==== #}
											<div class="nbreImages" title="Nombre d'images: {{ eventToCome.getImagesEvents | length }}">
												<i class="fas fa-file-image fa-lg"></i>
												{{ eventToCome.getImagesEvents | length }}
											</div>
										</div>
										{% if eventToCome.getImagesEvents[0] is defined %}
											{# On affiche l'image de l'event #}
											<img src="{{ asset('uploads/imagesEvents/' ~ 'min_' ~ eventToCome.getImagesEvents[0].Nom) }}">
										{% else %}
											{# On affiche l'image de remplacement par défaut #}
											<img title="Aucune image de disponible" src="{{ asset('images/min_imageDefaut.jpg') }}">
										{% endif %}
									</div>
								</td>
								<td>
									<a class="iconeEditer" href="{{ path('admin.events.edit', {id: eventToCome.id}) }}" title="Éditer"></a>

									{# formulaire avec champ caché (passer la valeur delete) pour supprimmer un évènement #}
									<form class="deleteForm" method="post" action="{{ path('admin.event.delete', {id: eventToCome.id}) }}" onsubmit="return confirm('Voulez-vous vraiment supprimer {{ eventToCome.nom }} ?')">
										<input
										type="hidden" name="_method" value="DELETE"/>
										{# On créé un token #}
										<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ eventToCome.id) }}"/>
										<button class="iconeSupprimer" title="Supprimer"></button>
									</form>
								</td>
							</tr>
						{% endfor %}
					{% endif %}
				</tbody>
			</table>
		</div>
	</div>
{% endblock %}
