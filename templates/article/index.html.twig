{% extends 'components/base.html.twig' %}
{% block stylesheets %}
<link rel="stylesheet" href="{{ asset('css/fullPageElement.css') }}">
<link rel="stylesheet" href="{{ asset('css/carousel.css') }}">
<link rel="stylesheet" href="{{ asset('css/boutonsEtInputs.css') }}">

{% endblock %}
{% block title %}
{{ SiteName }}:
{{ article.titre }}
{% endblock %}

{% block body %}



<div class="wrapper">
	<h1>{{ article.titre }}</h1>
	<section class="full-element">
		{% if article.getImagesArticles is not empty %}
		{# On affiche les images dispo dans le tableau #}
		{% for image in article.getImagesArticles %}
		<div class="image">
			<img src="{{ asset('uploads/imagesArticles/' ~ image.nom) }}" alt="">
			{# On affiche la légende de chaque image #}
			{% if image.caption is defined and image.caption != "" %}
			<div class="image-caption">
				<div class="text-image-caption">
					{{ image.caption }}
				</div>
			</div>
			{% endif %}
		</div>
		{% endfor %}
		{# On affiche les boutons et infos du carousel, sauf s'il n'y a qu'une image #}
		{% if article.getImagesArticles|length == 1 %}
		<div class="boutonsAndBulletsWrapper">
			<div class="boutonsNav hidden">
				<a class="prev">---</a> {# Petit bricolage, sinon, décalage de l'affichage #}
				<a class="next">---</a>
			</div>
		</div>
		{% else %}
		<div class="boutonsAndBulletsWrapper">
			<div class="boutonsNav">
				<a class="prev" onclick="plusSlides(-1)">&#10094;</a>
				<a class="next" onclick="plusSlides(1)">&#10095;</a>
			</div>
			{% set n = 0 %}
			<div class="blocBullets">
				{% for image in article.getImagesArticles %}
				{% set n = n + 1 %}
				<div class="bullet" title="{{ image.caption }}" onclick="currentSlide({{ n }})">
					<p>{{ n }}</p>
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}

		<div class="textes">
			{% else %}
			<div class="textes element-sans-image">
				{% endif %}
				<h2 class="hook">
					{{ article.hook }}
				</h2>


				<div class="contenu">
					{{ article.contenu | nl2br | auto_link | auto_internal_link }}
				</div>

				<div class="info-bar-bottom">
					<div class="ligne-left-items">
						<div class="info-bar-left">
							<div class="type-vue-and-status">
								{% if article.epingle %}
								<span class="articles-epingle-on" title="Épinglé">
									<i class="fas fa-thumbtack silver"></i>
								</span>
								{% endif %}
							</div>
							Date article:
							<div class="date">
								<i class="fas fa-calendar-alt"></i>
								{{ article.getCreatedAt | date("d-m-Y") }}
							</div>
							<div class="time">
								<i class="fas fa-clock"></i>
								{{ article.getCreatedAt | date("H:i") }}
							</div>
						</div>


					</div>
					<div class="ligne-left-items">
						<div class="bloc-nav-plus-moins">
							{% if previousArticleByDateId is not empty %}
							<a class="bt-small-rond" title="Article précédent"
								href="{{ path('article', {id: previousArticleByDateId}) }}">
								<i class="fas fa-arrow-left fa-lg"></i>
							</a>
							{% else %}
							<div class="bt-small-rond bt-small-rond-desactive" title="Article précédent">
								<i class="fas fa-arrow-left fa-lg"></i>
							</div>
							{% endif %}

							<div class="infos-naviguer">
								<div class="num-article">
									{{ numArticle }}/{{ nbreArticlesByCat }}
								</div>
								Prochain article de la catégorie
							</div>

							{% if nextArticleByDateId is not empty %}
							<a class="bt-small-rond" title="Article suivant"
								href="{{ path('article', {id: nextArticleByDateId}) }}">
								<i class="fas fa-arrow-right fa-lg"></i>
							</a>
							{% else %}
							<div class="bt-small-rond bt-small-rond-desactive" title="Article suivant">
								<i class="fas fa-arrow-right fa-lg"></i>
							</div>
							{% endif %}
						</div>
						<div class="bloc-boutons">
							{% if article.categoriesArticle.nom is defined %}
							{# Lien vers la page de la catégorie #}
							<a class="bouton bt-small marge-boutons"
								title="Tous les articles de la catégorie {{ article.categoriesArticle.nom }}"
								href="{{ path('categorie.articles', {idCategorie: article.categoriesArticle.id}) }}">
								{{ article.categoriesArticle.nom }}
							</a>
							{% endif %}

							<a class="bouton bt-small marge-boutons" title="Tous les articles, toutes catégories confondues"
								href="{{ path('articles') }}">
								Toutes les catégories
							</a>
							{# On n'affiche pas le lien contact quand c'est la catégorie Partenaires ou Mentions légales car ça
							peut
							prêter à confusion #}
							{% if article.categoriesArticle.nom and
							article.categoriesArticle.nom != "Partenaires" and
							article.categoriesArticle.nom != "Mentions légales" %}
							<a class="bouton bt-small marge-boutons"
								href="{{ path('contact', {id: article.id, categorie: article.categoriesArticle.nom}) }}"
								title="Nous contacter à propos de cet article">Contact</a>
							{% endif %}
							<a class="bouton bt-small marge-boutons" title="Accueil"
								href="{{ path('home') }}">
								Retour à l'accueil
							</a>
						</div>

						<div class="bloc-admin">
							{# On affiche la clé anglaise "gérer", quand on est connecté en admin #}
							{% if app.user and app.user.roles[0] == "ROLE_ADMIN" %}
							<div class="gerer">
								<a href="{{ path('admin.articles.edit', {id: article.id}) }}" title="Éditer l'évènement">
									<i class="fas fa-edit fa-2x blue"></i>
								</a>
							</div>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
	</section>
</div>

{% block javascript %}
<script src="{{ asset('js/carousel.js') }}"></script>
{% endblock %}
{% endblock %}